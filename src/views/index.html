<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Productos</title>
  <link rel="stylesheet" href="styles.css">
</head>
<body class="products-page">

<header>
  <h1>Gestión de Productos</h1>
  <button id="logout">Cerrar sesión</button>
</header>

<main>
  <div class="form-section">
    <h2>Agregar Producto</h2>
    <input type="text" id="name" placeholder="Nombre">
    <input type="number" id="price" placeholder="Precio">
    <input type="number" id="stock" placeholder="Stock">
    <button id="addProduct">Agregar</button>
    <p id="error"></p>
  </div>

  <div class="products-section">
    <h2>Lista de Productos</h2>
    <ul id="productList"></ul>
  </div>
</main>

<footer>
  <img src="img/header.webp" alt="Foto decorativa de pie de página" class="pie">
  <p>&copy; 2025 Bolsos de lujo</p>
</footer>

<script>
/* Simulación de productos en memoria y login falso */
let mockProducts = [];
let token = localStorage.getItem('token') || null;

if (!token) {
  alert('Simulación: inicia sesión primero');
  token = 'fake-token'; // Token simulado
  localStorage.setItem('token', token);
}

const productList = document.getElementById('productList');
const errorMsg = document.getElementById('error');

function loadProducts() {
  productList.innerHTML = '';
  mockProducts.forEach(p => {
    const li = document.createElement('li');
    li.innerHTML = `
      ${p.name} | $${p.price} | Stock: ${p.stock}
      <button class="edit" onclick="editProduct('${p.id}')">✎</button>
      <button class="delete" onclick="deleteProduct('${p.id}')">X</button>
    `;
    productList.appendChild(li);
  });
}

document.getElementById('addProduct').onclick = addProductHandler;

function addProductHandler() {
  errorMsg.textContent = '';
  const name = document.getElementById('name').value;
  const price = document.getElementById('price').value;
  const stock = document.getElementById('stock').value;

  if (!name || !price || !stock) {
    errorMsg.textContent = 'Todos los campos son obligatorios';
    return;
  }

  const id = Date.now().toString(); // ID simple
  mockProducts.push({ id, name, price, stock });

  document.getElementById('name').value = '';
  document.getElementById('price').value = '';
  document.getElementById('stock').value = '';

  loadProducts();
}

function deleteProduct(id) {
  mockProducts = mockProducts.filter(p => p.id !== id);
  loadProducts();
}

function editProduct(id) {
  const product = mockProducts.find(p => p.id === id);
  if (!product) return;

  document.getElementById('name').value = product.name;
  document.getElementById('price').value = product.price;
  document.getElementById('stock').value = product.stock;

  const addBtn = document.getElementById('addProduct');
  addBtn.textContent = 'Actualizar';

  addBtn.onclick = () => {
    product.name = document.getElementById('name').value;
    product.price = document.getElementById('price').value;
    product.stock = document.getElementById('stock').value;

    addBtn.textContent = 'Agregar';
    addBtn.onclick = addProductHandler;

    document.getElementById('name').value = '';
    document.getElementById('price').value = '';
    document.getElementById('stock').value = '';

    loadProducts();
  };
}

document.getElementById('logout').onclick = () => {
  localStorage.removeItem('token');
  alert('Sesión cerrada (simulación)');
  window.location.reload();
};

loadProducts();
</script>

</body>
</html>